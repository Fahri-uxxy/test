-- Check jika GUI sudah ada, hapus dulu agar tidak double
if game.Players.LocalPlayer.PlayerGui:FindFirstChild("MobileAutoOpenUI") then
    game.Players.LocalPlayer.PlayerGui.MobileAutoOpenUI:Destroy()
end

-- --- CONFIGURATION ---
local ItemName = "Soul Scythe"
local DelayTime = 0.5 -- Waktu jeda antar open (detik). Jangan terlalu cepat agar tidak crash/kick.
-- ---------------------

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")

-- Mendapatkan Controller Target
local success, GiftingController = pcall(function()
    return require(ReplicatedStorage:WaitForChild("Controllers"):WaitForChild("GiftingController"))
end)

if not success then
    warn("GiftingController tidak ditemukan! Pastikan game sudah loading sepenuhnya.")
    return
end

-- UI Creation
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local ToggleButton = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")
local UICornerBtn = Instance.new("UICorner")
local CloseButton = Instance.new("TextButton")

ScreenGui.Name = "MobileAutoOpenUI"
ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false -- Agar UI tidak hilang saat mati

-- Main Frame (Kotak Utama)
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
MainFrame.Position = UDim2.new(0.1, 0, 0.2, 0) -- Posisi awal di kiri agak atas
MainFrame.Size = UDim2.new(0, 200, 0, 110)
MainFrame.Active = true
MainFrame.Draggable = true -- Agar bisa digeser di HP

UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = MainFrame

-- Judul
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1.000
Title.Position = UDim2.new(0, 0, 0, 5)
Title.Size = UDim2.new(1, 0, 0, 25)
Title.Font = Enum.Font.GothamBold
Title.Text = "Auto " .. ItemName
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 14.000

-- Tombol Toggle (On/Off)
ToggleButton.Parent = MainFrame
ToggleButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- Merah (OFF)
ToggleButton.Position = UDim2.new(0.1, 0, 0.35, 0)
ToggleButton.Size = UDim2.new(0.8, 0, 0.4, 0)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.Text = "OFF"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 20.000

UICornerBtn.CornerRadius = UDim.new(0, 8)
UICornerBtn.Parent = ToggleButton

-- Tombol Close (X kecil)
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
CloseButton.BackgroundTransparency = 1
CloseButton.Position = UDim2.new(0.85, 0, 0, 0)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(200, 200, 200)
CloseButton.TextSize = 14.000

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- --- LOGIC SCRIPT ---
local toggled = false

ToggleButton.MouseButton1Click:Connect(function()
    toggled = not toggled
    
    if toggled then
        -- Saat ON
        ToggleButton.Text = "ON"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 200, 50) -- Hijau
        
        -- Loop function
        task.spawn(function()
            while toggled do
                pcall(function()
                    GiftingController:Open(ItemName)
                end)
                task.wait(DelayTime) -- Jeda waktu
            end
        end)
    else
        -- Saat OFF
        ToggleButton.Text = "OFF"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- Merah
    end
end)

print("Script Loaded! UI Draggable (Bisa digeser).")
